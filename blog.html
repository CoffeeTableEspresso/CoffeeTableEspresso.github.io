<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="my website">
<base href="/">
<title>CoffeeTableEspresso - blog</title>
<link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
  
  <!-- Header -->
    <!-- include includes/header.html here -->
  <header>
    <div>
      <a href="index.html">home</a>
    </div>
  </header>
  
  <div>
    <h1> about </h1>
    <p> mostly me writing about stuff i'm working on for future reference. link to my current project's webpage, 
      <a href="yasl.html">YASL</a>.
    </p>
    <h1> 09/04/2018 </h1>
    <p> my friend suggested an idea for a language: Python, but where you can inline an SQL-like language, and have it work
      flawlessly with the Python. i've actually had a need for this, and even implemented a similar thing with my 
      <a href="https://github.com/CoffeeTableEspresso/CourseBrowserImproved">CourseBrowserImproved</a> project. if 
      i forked the <a href="https://github.com/python/cpython">main Python repo</a>, i could probably do it pretty easily.
      i might give it a try over the summer.
    </p>
    <h1> 08/04/2018 </h1>
    <p> for my software engineering club, i've been given permission to start (and lead) a programming language team. the 
      idea is we spend 8 months and write a compiler/interpreter for a language. not sure of any details beyond that. i've 
      had a few people interested so far, plus i can recruit from outside the club, so hopefully i have a team. this is my 
      first real leadership role ever, so hopefully it goes through and works out.
    </p>
    <p> i've linked a few friends to YASL and they've had positive reactions. i think once i get a few more features working,
      plus some sample code/tutorials, i'll put a link to YASL on reddit, to get some advice on it.
    </p>
    <h1> 07/04/2018 </h1>
    <p> i'm almost at a point where i can start using YASL for writing actual programs, which is very exciting. </p>
    <p> figured out how to add <code>break</code> and <code>continue</code> to YASL. i had to refactor the compiler to keep 
      track of how far i've gone in the bytecode. once i know where i am in the bytecode, i can basically use a GOTO with a
      small offset to jump to the start of the loop. i just have to implement it, and work out a few small details. 
    </p>
    <h1> 01/04/2018 </h1>
    <p> added basic i/o stuff: <code>stdin</code>, <code>stdout</code>, <code>stderr</code>, <code>open(...)</code>, 
      <code>file.close(...)</code>, <code>file.write(...)</code>, <code>file.read(...)</code>,
      <code>file.readline(...)</code>. i have a double free bug somewhere, i'm gonna try to find
      it once i'm home and have my PC. I also want to do a refactoring. CLion stopped working on my laptop for unknown 
      reasons, and i don't want to refactor my C code by hand in PyCharm.
    </p>
    <p> i want to add <code>popen(...)</code> too, (it'll basically be the same as in C,) but i'm gonna refactor thing a bit 
      first, because a few parts of my code 
      are getting kinda messy. i want to split all the methods up based on the builtin type they belong to, and add an
      C object for files. i also have to decide exactly how <code>popen(...)</code> should should work in YASL.
    </p>
    <h1> 30/04/2018 </h1>
    <p> added input from users: <code>input ...</code>. i should probably make this and <code>print</code> a function later 
      on. 
    </p>
    <p> gonna try to add more i/o stuff in the next few days. hopefully i can write a small assembler for YASL bytecode, in
      YASL, soon. eventually i'd like to get the whole compiler self-hosting.
    </p>
    <p> got stdin, stdout, stderr "working", although i only have a <code>write</code> method working right now. at least the
      hard work of setting up the vtables, adding a new type, etc, is done. i'll try to get a bit more working tmr.
    </p>
    <h1> 28/04/2018 </h1>
    <p> my friend <a href="https://github.com/ryco117">ryco117</a> helped me out with YASL yesterday. i've got a nice 
      makefile now. he suggested adding bitwise operators, but i'm not sure of the syntax. i could use the classic 
      <code>|, &amp;, ^</code>, but i kinda want <code>|</code> for piping and <code>^</code> for exponentiation.
      we'll see what YASL actually needs.
    </p>
    <h1> 27/04/2018 </h1>
    <p> added integer division, using syntax <code>a//b</code>. only accepts integers, as i can't think of a use case for
      floats, at least not a very important one. i also added conversions between numeric types soon, via builtin methods:
      <code>x.toint64()</code> converts a float to an int, <code>x.tofloat64()</code> converts an int to a float.
    </p>
    <h1> 26/04/2018 </h1>
    <p> wrote a small assembler for my YASL bytecode this morning. it basically just lets me write using the YASL opcodes,
      with comments. it doesn't have anything fancy like macros, which is fine because i bascically just need it to test
      things before i get my compiler to generate the bytecode for me.
    </p>
    <h1> 25/04/2018 </h1>
    <p> added for-loops, with syntax: <code>for x &lt;- y { ... }</code>. sorted out all the bugs, they can be nested, etc.
      i think i might write a small assembler (for my 
      bytecode) to help me with things, it's kind of a pain to write all the bytecode by hand or generate it all from 
      scratch.
    </p>
    <p> gonna try to add list-comprehensions at some point, although i don't need them as much as for-loops. </p>
    <h1> 24/04/2018 </h1>
    <p> so my promise not to work on YASL lasted about a week. i added literals for lists and maps. <code>[]</code> is the 
      empty list, <code>[-&gt;]</code> is the empty map. gonna try to add for-loops soon, then list-comprehensions.
    </p>
    <p> turns out i'm third on Google for "YASL Language". i bet i could get it better with some SEO. </p>
    <h1> 23/04/2018 </h1>
    <p> for defining methods, i'm not quite sure of the syntax yet. either: 
      <code>defun str8.methodname: -&gt; { ... }</code> 
      or <code>defun (s str8) methodname: -&gt; { ... }</code> would be fine, or some slight variation on either of the 
      above.
    </p>
    <h1> 22/04/2018 </h1>
    <p> i'm taking a break from coding any side projects so i don't get bad grades. </p>
    <p> i think i'm gonna steal embedded structs from Go, proper OOP stuff is way too much for a scripting language. this 
      will also work nicely with me allowing users to define methods on builtin types.
    </p>
    <p> i'm gonna change <code>list(...)</code> to <code>[...]</code>, and same for hashes. i'll also probably rename hashes
      to maps (with literal: <code>[x->y, ...]</code>) or something similiar so i can use <code>hash</code> for a hash 
      function.
    </p>
    <p> i'm also gonna add for loops, list comprehensions, and type-hinting. </p>
    <p> for loops: <code>for x &lt;- y { ... }</code>. list comprehensions: e.g. <code>[f(x) : x &lt;- y, x &gt; 0]</code>. 
      type
      hinting: <code>let x int64 = 167</code>. (i'm using the <code>&lt;-</code> to indicate that the left side is taking
      values by iterating over the right side.)
    </p>   
    <p> type hinting will also work nicely with structs, although i'm not quite sure how to implement type hinting yet. </p>
    <p> i'm also gonna have to implement a bunch of standard library stuff in C. </p>
    <h1> 04/04/2018 </h1>
    <p> one of my friends said he wanted to help out with my 
      <a href="https://github.com/CoffeeTableEspresso/CourseBrowserImproved">CourseBrowserImproved</a> project. i originally
      got it to a point that i was happy with, but now that i've learned more about languages and parsing, i think i could
      add in some of the features that i originally thought were too complicated, and with his help, coding everything 
      would be a lot faster. I'd also love to fix up a few issues I had, such as it not running on Windows, due to my 
      sloppy packaging.
    </p>
    <h1> 03/03/2018 </h1>
    <p> added a basic string search algorithm. i used a na√Øve implementation; i intend to fix this up in the future once
      i've got more time, but this should work for now. i'm gonna do a split function too.
    </p>
    <p> i've got to get methods and stuff working, as in, tie everything to the type it belongs with. i'll basically use 
      my functions i have so far for this.
    </p>
    <h1> 28/02/2018 </h1>
    <p> getting equality to work out with the semantics i want is hard. even Python doesn't implement it as nicely as i'd
      like. try making two empty lists, <code>x,y = [], []</code>, then appending each list to itself, i.e.
      <code>x.append(x)</code>, <code>y.append(y)</code>. then compare them: <code>x == y</code>. 
      <code>RuntimeError: maximum recursion depth exceeded in comparison</code>. not a very common example, but i still
      don't think you should get an error for equality comparison ever.
    </p>
    <p> going to implement string functions soon, and fix hashtables so they don't take mutable keys by default. (adding a 
      <code>id(...)</code> function will probably also happen.)
    </p>
    <h1> 27/02/2018 </h1>
    <p> refactored strings to make them easier to deal with internally. i've decided that the empty string 
      <code>&quot;&quot;</code> should be falsey (bringing my falsey values up to <code>false</code>, <code>undef</code>,
      and <code>&quot;&quot;</code>), in order to let me do things like <code> while line = &lt;stdin&gt; { ... } </code>, 
      which reads a line from <code>stdin</code>,  assigns its value to <code>line</code>, and terminates when the user 
      presses enter without giving any input.  a similar construct should work for reading from arbitrary filehandles. 
      this is nice for reading files; a similar construct in say, python, is much more verbose. (of course, python has 
      other nicer constructs for doing the same kind of thing.) the <code>&lt;...&gt;</code> operator is taken from Perl. 
      in general i want to avoid Perl's complexity, but i think in a few cases it makes sense to have dedicated operators 
      to do some things.
    </p>
    <p>
      i need to start adding file stuff to YASL soon. i'm going to leave off dealing with the rest of the 
      string functions until i need them, because they're not that interesting and i can't do much with them if i can't 
      get intput. 
    </p>
    <h1> 19/02/2018 </h1>
    <p> got lists working, as well as hashtables, and added brackets as a way of indexing into both lists and hashes. i've 
      sort-of finalised the opcodes for constants, which let me do some nice bit masking, as well as the opcodes for 
      most of the infix operators.  once i have this VM working nicely, i could (in theory) write another language to 
      target it pretty easily. just a thought.
    </p>
    <p> i also added a modulo operator, solely for integers (when's the last time you took mod of a float?). i'm going to 
      clean up builtin functions a bit more, then add some stuff for I/O. i would also like to have a dedicated bytes type.
      i figure i should at least learn something from Python 2.
    </p>
    <p> eventually, i hope to make a self-hosting compiler for YASL (and continue to use the C-based VM I currently have for 
      executing the bytecode).  still a long way to go, and i would also like to do some other projects, for example,
      fix up <a href="https://github.com/CoffeeTableEspresso/CourseBrowserImproved">CourseBroswerImproved</a> project, and
      use my PC for some ML.
    </p>
    <p>
      i bought a new PC at the start of the school year, but was much too busy last term to give it
      a try (to clarify: i used it, but i didn't get to use the full power of it), but i've recently set up Keras and 
      TensorFlow on it, and ran a few neural nets on the GPU. so far, i'm very happy with the 
      <a href="https://www.nvidia.com/en-us/geforce/products/10series/geforce-gtx-1060/">GTX 1060</a>. i'm not doing 
      anything so crazy that i need anything better ATM, although we'll see. another GPU to run multiple things in parallel
      might be nice, although i doubt that's really gonna come up often enough to be worth dropping hundreds on another
      GPU.
    </p>
    <h1> 15/02/2018 </h1>
    <p> i've still been working on YASL, just haven't been updating this.  managed to get  (and a few basic string 
      functions) and hash tables working, gonna do lists as well soon, but have mostly been focusing on cleaning up 
      the code for when i want to add more stuff. i'm gonna finalise the opcodes soon, at least some of them,
      so that i can start cutting my code down a bit via bit masking. the other benefit of doing this is i'll be able 
      to start writing up documentation without worrying that it might change constantly. i'm gonna do a bit more work 
      on the what i currently have, make it really tight, then add classes.
    </p>
    <p> i've shown this to two of my profs, they've both been pretty impressed with it. they both recommended i talk with
      a third prof, someone who is apparently <em> THE </em> guy to talk to about programming languages at my school,
      but he's away until april, so we'll see how that goes. 
    </p>
    <p> i also need to decide what builtin functions i want, and then organise those in a way that makes adding more easy.
    </p>
    <h1> 23/01/2018 </h1>
    <p> showed YASL to my friend yesterday, and he immediately broke it trying to write fibonacci recursively. </p>
    <p> turns out i was accidentally popping off the top of stack sometimes, which was messing up my local variables. 
      that's what i get for trying to 1-index.
    </p>
    <h1> 21/01/2018 </h1>
    <p> added functions to YASL today. also got a job last week, which should give me some extra free time now that i've got 
        that done. i still need to add return statements to functions, but that should be easy. going to have to talk to
        my one prof about implementing classes in bytecode. 
    </p>
    <p>
      i think i'm going to clean up the code and docs, then post on 
        reddit once i'm done to get some advice from more experienced people.
    </p>
    <h1> 14/01/2018 </h1>
    <p> just got back from my first hackathon, <a href="https://www.nwhacks.io/">nwHacks 2018</a>. our team didn't win (or 
        even do very well), but it was very fun. the best part was being in a room full of ppl who really care about CS. 
        courses at school are fine, but most of the ppl there don't give a f*ck about CS. at nwHacks tho, everyone loves 
        CS. the excitement in their voices when they talked about their projects (or really anything to do with CS) was 
        wonderful to hear. 
    </p>
    <p> i also got a bunch of swag. google gave out blankets and pillows, as if they need the publicity. </p>
    <p> i'm back to job appls this evening. got an interview lined up for Tu morning, waiting to hear back from a bunch of 
        other places.
    </p>
    <p> i've figured out how to deal with expression-statements filling up the stack, i'll implement/explain tmr. </p>
    <p> dealt with expression-statements filling up the stack, just popped the top of the stack after an 
        expression-statement. i think i'm finally ready to move onto functions.
    </p>
    <h1> 11/01/2018 </h1>
    <p> functions should be pretty straightforward, i've already set up most of the stuff i need (e.g. frame pointer) ahead 
        of time. i'll fix that up once i'm done job appls.
    </p>
    <p> i'd love to write a full C compiler one day, but it would involve a lot of work because of the ambiguity. e.g. if i 
        write <code>(A)*B</code>, am i multiplying <code>A</code> and <code>B</code> or am i dereferencing <code>B</code> 
        and casting it to type <code>A</code>? who knows, unless i can see the rest of the source code, and this is where 
        the problems come in. there's a lot more examples too, BTW. (here's a few one line ones; things get really f*cked 
        up when you're dealing with scopes. maybe i'll post about it later.):
    </p>
    <ul>
      <li><code>(A)*B;</code>: mentioned above.
      <li><code>A * B;</code>: declaring a pointer to something of type <code>A</code> or multiplication?</li>
      <li><code>(A)-B;</code>: casting <code>-B</code> to type <code>A</code> or subtracting?</li>
      <li><code>(A)+B;</code>: casting <code>+B</code> to type <code>A</code> or adding?</li>
      <li> lots of the really f*cked up ones take up multiple lines, so i'll omit them or make them a post later.</li>
    </ul>
    <h1> 10/01/2018 </h1>
    <p> added assignment expressions. i decided that assignment is an expression, and declaration is a statement. this may 
        not be the best choice, seeing as this causes a lot of C errors from assignments in if/for/while conditions. may 
        change this in the future to either disallow assignments in these places or make assignments a statement. i like 
        being able to assign multiple variables to the same value all at once tho, without having to add a separate 
        construct for this.
    </p>
    <p> the big thing with adding assignments was that it let me add (non useless) while loops. had to use a backwards and a
        forward branch. couldn't think of a clever way to optimise things based on the size of the jump, because each jump 
        size depends on the other. i'm sure i could get close, like within 9 bytes or something.
    </p>
    <p> looks like functions are next. should be pretty straightforward. i think i have a small bug where expression 
        statements end up filling up the stack with their values, i'll have to fix that first, otherwise functions will have 
        a bunch of problems.
    </p>
    <h1> 09/01/2018 </h1>
    <p> got automatic semicolon insertion working nicely, just have to clean my code up a bit before i commit. </p>
    <p> added if-elseif-else-statements. also am going to add more branch opcodes, to deal with different length jumps in 
        addresses. (so i don't have to deal with wasting 8 bytes of opcode jumping over a print statement, e.g.)
    </p>
    <p> next step is assignment statements, then while-loops. 
        while-loops are basically useless without assignment statements, since i'd only be able to declare local variables,
        and would always get stuck in an infinite loop (unless i did something useless like <code>while false { ... }</code>.
    </p>
    <h1> 08/01/2018 </h1>
    <p> i seriously need to: </p>
    <ul>
      <li> add automatic semicolon insertion √† la Go. i think the problems with my technique are becoming apparent. i 
        shouldn't really add more features until i clear this up. 
      </li>
      <li> write a function to turn a constant int to a bunch of bytes in the interpreter.
        i've copied the same lambda around like 5 times by now. i actually need to really refactor a lot of pieces of the 
        code. e.g. i want to make a few different branch instructions for different sizes of ints. i think i have enough 
        opcodes left that this should be fine.
      </li>
      <li> actually, while i'm at it i'll clean up all my code, and add proper error messages. 
        things are gonna get bad soon if i don't.
      </li>
    </ul>
    <p> i also added if-else-statements, which is what made these problems apparent in the first place. 
        if-elseif-...-elseif-else-statements can be done with nested if-else-statements, i'll add those once i sort out the 
        semi-colon thing described above.
    </p>
    <h1> 07/01/2018</h1>
    <p> figured out how to implement nested scopes, will actually implement them soon. i plan on using nested envs while 
        walking the AST to figure out where to store everything in memory at runtime. i'll post a better explanation when i 
        acutally write up the code. it's easy to say "i know how to do X", it's another to actually do X. maybe i'm 
        overlooking something. i'll try implementing if-statements and while-loops tmr/tonight. once i have those, it'll be 
        easy to do any other kind of loop,  and to extend if-statements to if-else-statements and 
        if-elseif-....-elseif-else-statements.
    </p>
    <p> right now i'm doing a bunch of job appls, need something for this summer, so i don't have a lot of spare time. </p>
    <p> implemented lexical scoping and if-statements, after redoing my resume. i think i need to implement assignment 
        before i can move on to else statements and loops, otherwise what's the point if i can't assign to global variables 
        inside a local scope.
    </p>
    <p> i think i should do automatic semicolon insertion, √† la Go. it would make typing things out a lot easier. </p>
    <h1> 06/01/2018 </h1>
    <p> added <code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, and <code>&lt;=</code>. i basically reused the same 
        macro as for the binary operators, although i changed it a bit, because i wanted to return a bool, not an int.
    </p>
    <p> added <code>==</code> and <code>!=</code>, which are for value equality. (what i mean by value equality, is (e.g.) 
        two strings are value-equal if they contain the same characters, even if they are stored in different spots in 
        memory. i'll clarify more when i add operators for reference equality later or when i add more complicated types 
        like strings.) i'll add reference equality later, probably as <code>===</code> and <code>!==</code>.
    </p>
    <p> oh, semantics of value equality: </p>
    <ul>
      <li><code>nil</code> compared with anything returns <code>nil</code>.</li>
      <li>ints and floats can be compared with each other and return the expected values. (e.g. <code>1 == 1.0</code> 
          returns <code>true</code>.)</li>
      <li>booleans compared with each other as expected.</li>
      <li>all other comparisons across types return <code>false</code>. (e.g. <code>1 == true</code> 
          returns <code>false</code>.)</li>
    </ul>
    <h1> 05/01/2018 </h1>
    <p> added <code>nil</code> value. </p>
    <p> i figured out how to do if-statements and while-loops, but i need to implement scopes first. </p>
    <p> i implemented the ternary operator (same as C, unless i f*cked something up), using branch if false
        and unconditional branch. 
    </p>
    <p> i decided that <code>false</code> and <code>nil</code> are falsey, and everything else is truthy. this
        seems like the cleanest way to do things. i'm not a big fan of the python way of having the trivial instances of 
        everything (empty string, empty list, empty anything, None, false, 0, etc) be falsey. it just feels like too many.
    </p>
    <p> once i figure out scopes i'll add while-loops and if statements. </p>
    <p> actually, i guess adding <code>!</code>, <code>and</code>, <code>or</code>, comparators, etc is probably the next 
      step now that i have the ternary operator and booleans. 
    </p>
    <p> added <code>!</code>, <code>and</code>, <code>or</code>. will work on comparators later. 
        <code>and</code> and <code>or</code> shortcircuit, which took me a while to figure out how to implement
        without adding registers to my VM. long story short, i got it working, but i had to add a "duplicate" instruction
        to the VM, to let me get away with only evaluating the left condition once.
    </p>
    <p> the idea is, push the left side onto the stack, duplicate it, push the size of the right side + 1 onto the stack,
        branch if the left side is truthy (for <code>or</code>) or falsey (for <code>and</code>) 
        (this skips over all the stuff for the right side if we branch), pop top of stack 
        (this gets rid of the second copy of the left side from stack), then push the right side to stack. 
        this is not the best explanation, since i haven't actually explained how my VM or bytecodes actually work, 
        but hopefully it gives an idea.
    </p>
    <p> maybe there's a better way to do this, but nothing comes to mind. </p>
    <p> cleaned up the code for the binary operators a lot by making it into a macro, since it was basically the same for 
        add, multiply and subtract.
    </p>
    <h1> 04/01/2018 </h1>
    <p> added booleans. </p>
      
  </div>
</body>
</html>
